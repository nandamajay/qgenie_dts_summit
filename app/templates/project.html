{% extends "base.html" %}

{% block content %}
<div class="row" style="margin-bottom:16px;">
    <a href="/"><button class="secondary">&larr; Dashboard</button></a>
    <h2>{{ name }}</h2>
</div>

<div class="card">
    <div class="row" style="justify-content:space-between">
        <h3>Source Repository</h3>
        <form action="/clone/{{ name }}" method="post">
            <button type="submit" {% if state.status == 'cloning' %}disabled{% endif %}>
                {% if state.status == 'cloning' %}Syncing... {{ state.percent }}%{% else %}Sync Files (Sparse){% endif %}
            </button>
        </form>
    </div>
    <div style="background:#000; padding:10px; font-family:monospace; font-size:12px; height:80px; overflow-y:auto; color:#a5b4fc; margin-top:16px; border-radius:6px;">
        {{ state.log or 'Log waiting...' }}
    </div>
</div>

<div class="card">
    <h3>Device Tree Files (DTSI)</h3>
    {% if files %}
        <ul style="columns: 2; list-style: none; padding: 0;">
        {% for f in files %}
            <li style="margin-bottom:6px;">
                <span style="font-family:monospace; color:#cbd5e1;">{{ f }}</span>
                <a href="/analyze/{{ name }}/{{ f }}" style="float:right; color:#38bdf8; font-weight:bold; font-size:13px;">Analyze &rarr;</a>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <div class="dim">No files found. Please sync the repository.</div>
    {% endif %}
</div>
{% endblock %}
